<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>文件编辑器</title>
    <style>
      * {
        touch-action: pan-y;
      }
      body {
        padding: 0;
        margin: 0;
      }
      #editor-container {
        height: 100vh;
        width: 100vw;
      }
    </style>
  </head>
  <body>
    <div id="editor-container">
      <div id="editor"></div>
    </div>
    <script src="/resources/md5.min.js"></script>
    <script src="/resources/helper.js"></script>
    <!-- <script src="http://localhost:18084/web-apps/apps/api/documents/api.js"></script> -->
    <script src="/web-apps/apps/api/documents/api.js"></script>
    <script>
      // window.location.href = `http://localhost:18082/?url=https://images.joriving.com:9090//purchase/1/commonfile/1642575406908.docx&fileName=%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92.docx`;
      window.onload = function () {
        const info = pathPraser();
        new DocsAPI.DocEditor("editor", {
          document: {
            // fileType: "docx",
            fileType: info.fileType,
            // key: "12NAFE",
            key: info.key,
            // title: "1642575406908.docx",
            title: info.title,
            // url: "https://images.joriving.com:9090//purchase/1/commonfile/1642575406908.docx",
            url: info.url,
          },
          documentType: info.documentType,
          height: "100%",
          width: "100%",
          editorConfig: {
            callbackUrl: "",
            lang: "zh-CN", // 中文
            mode: "view", // 预览模式
            customization: {
              anonymous: {
                request: false,
                label: "Guest",
              },
              plugins: false,
              comments: false, // 关闭评论
              chat: false, // 关闭聊天
              // logo: {
              //   url: null, // 设为 null 不可修改
              // },
              logo: {
                image: "./img/min.png",
                imageDark: "./img/min.png",
                url: "http://www.joriving.com/",
              },
              // customer: null, // 没有效果
            },
          },
          permissions: {
            comment: true,
            download: true,
            edit: true,
            fillForms: true,
            print: true,
            review: true,
          },
        });
      };
    </script>
  </body>
</html>
